<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…ÙŠØ²Ø§Ù†</title>
  <!-- ØªØ¶Ù…ÙŠÙ† Bootstrap -->

  <!-- Bootstrap JS (Ù…Ø¹ Popper.js) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Ø£Ù†Ù…Ø§Ø· Ø¥Ø¶Ø§ÙÙŠØ© */
    body {
      padding-top: 56px;
      /* Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¯Ø§Ø®Ù„ Ù…Ø¹ Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
    }

    .sidebar {
      height: calc(100vh - 56px);
      overflow-y: auto;
    }

    .content {
      min-height: calc(100vh - 56px);
    }
  </style>
</head>

<body>
  <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
    <div class="container-fluid">
      <button class="btn btn-outline-light me-4" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu"
        aria-controls="sidebarMenu">
        â˜° Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©

        <!-- Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø© Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
        <small id="streamIndicator" style="display: none;">

          <span class="badge bg-danger">ğŸ”´</span>
          <span id="online-indicator"></span>
        </small>
      </button>
      <a class="navbar-brand" href="#">Ù…ÙŠØ²Ø§Ù† Ø´ÙˆØ´Ø§Ù†</a>
      <button class="btn btn-info w-5 " onclick="sendCommand('SX')">ØªÙØ¹ÙŠÙ„</button>
      <button class="btn btn-info w-5 " onclick="sendCommand('EX')">Ø§ÙŠÙ‚Ø§Ù</button>

    </div>
  </nav>

  <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (Offcanvas) -->
  <div class="offcanvas offcanvas-start bg-light" tabindex="-1" id="sidebarMenu" aria-labelledby="sidebarMenuLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="sidebarMenuLabel">Ø§Ù„Ø£ÙˆØ§Ù…Ø±</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <ul class="nav flex-column">
        <li class="nav-item">
          <button class="btn btn-primary w-100 mb-2" onclick="sendCommand('XN2')">Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙˆØ²Ù† Ø§Ù„ØµØ§ÙÙŠ</button>
        </li>
        <li class="nav-item">
          <button class="btn btn-primary w-100 mb-2" onclick="sendCommand('KZERO')">ØªØµÙÙŠØ± Ø§Ù„Ù…ÙŠØ²Ø§Ù†</button>
        </li>
        <li class="nav-item">
          <button class="btn btn-primary w-100 mb-2" onclick="sendCommand('KTARE')">ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ§Ø±ÙŠ</button>
        </li>
        <li class="nav-item">
          <button class="btn btn-primary w-100 mb-2" onclick="sendCommand('KPRINT')">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªØ°ÙƒØ±Ø©</button>
        </li>
        <li class="nav-item">
          <button class="btn btn-primary w-100 mb-2" onclick="sendCommand('SX')">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± </button>
        </li>
        <li class="nav-item">
          <button class="btn btn-primary w-100 mb-2" onclick="sendCommand('EX')">Ø§ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± </button>
        </li>
      </ul>
    </div>
  </div>

  <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
  <main class="container mt-4">
    <!-- <h2>Ø§Ù„Ø±Ø¯ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²:</h2> -->
    <div i class="alert alert-secondary">

      <h1 id="response">
        --
      </h1>


    </div>
    <h3 id="response11">
      --
    </h3>
    <!-- Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø© Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    <div id="streamIndicator" style="display: none;">
     
      <span class="badge bg-danger">ğŸ”´</span> <small>ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª </small>
      <span id="online-indicator"></span>
    </div> -->
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ­ÙƒÙ… -->
    <div class="container text-center">
      <div class="row align-items-start">
        <div class="col">
          <button class="btn btn-info w-100 mb-2" onclick="sendCommand('KPRINT')">PRINT</button>
        </div>
        <!-- <div class="col">
          <button class="btn btn-info w-100 mb-2" onclick="sendCommand('KUNITS')">UNITS</button>
        </div> -->
        <div class="col">
          <button class="btn btn-info w-100 mb-2" onclick="sendCommand('KTARE')">TARE</button>
        </div>
        <div class="col">
          <button class="btn btn-info w-100 mb-2" onclick="sendCommand('KZERO')">ZERO</button>
        </div>
        <div class="col">
          <button class="btn btn-info w-100 mb-2" onclick="sendCommand('Kid')">id </button>
        </div>
      </div>
    </div>



    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø±Ù‚Ù…ÙŠØ© -->
    <div class="container mt-4">
      <div class="row justify-content-center">

        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ -->
        <div class="col-md-8">
          <div class="d-flex flex-wrap gap-2">
            <button class="btn btn-primary w-25" onclick=" sendCommand('K1')">1</button>
            <button class="btn btn-primary w-25" onclick=" sendCommand('K2')">2</button>
            <button class="btn btn-primary w-25" onclick=" sendCommand('K3')">3</button>
            <button class="btn btn-primary w-25" onclick=" sendCommand('K4')">4</button>
            <button class="btn btn-primary w-25" onclick=" sendCommand('K5')">5</button>
            <button class="btn btn-primary w-25" onclick=" sendCommand('K6')">6</button>
            <button class="btn btn-primary w-25" onclick=" sendCommand('K7')">7</button>
            <button class="btn btn-primary w-25" onclick=" sendCommand('K8')">8</button>
            <button class="btn btn-primary w-25" onclick=" sendCommand('K9')">9</button>
            <button class="btn btn-primary w-25" onclick=" sendCommand('K0')">0</button>
            <button class="btn btn-danger  w-25" onclick=" sendCommand('KCLR')">Ù…Ø³Ø­</button>
            <button class="btn btn-success w-25" onclick="sendCommand('KENTER')">ENTER</button>
            <button class="btn btn-success w-25" onclick="sendCommand('KDISPTARE')">DISPLAY</button>
            <button class="btn btn-success w-25" onclick="sendCommand('KESCAPE')">ESCAPE</button>
            <button class="btn btn-success w-25" onclick="sendCommand('KUNITS')">UNITS</button>

          </div>
        </div>

        <!-- Ø§Ù„Ø¨ÙˆÙƒØ³ Ø¨Ø¬Ø§Ù†Ø¨ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ -->
        <div class="col-md-4">


          <div class="input-group mb-3">
            <input id="edpInput" type="text" placeholder="EDP input hereâ€¦" class="form-control">
            <div class="input-group-append">
              <!-- Ø²Ø± "X" Ù„Ø­Ø°Ù Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
              <button type="button" class="btn btn-outline-secondary" onclick="clearInput('edpInput')">X</button>
            </div>
            <div class="input-group-prepend">
              <!-- Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ -->
              <button type="button" class="btn btn-danger" onclick="sendTextCommand()">Send</button>
            </div>
          </div>
          <div class="input-group mb-3">
            <button type="button" id="streamButton" class="btn btn-primary" onclick="toggleStream()">Start
              Stream</button>
          </div>

          <script>
            let isStreaming = false; // Ù…ØªØºÙŠØ± Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù†Ø´Ø·Ù‹Ø§ Ø£Ù… Ù„Ø§
            let streamInterval; // Ù…ØªØºÙŠØ± Ù„ØªØ®Ø²ÙŠÙ† Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø¤Ù‚Øª
            let stopTimeout; // Ù…ØªØºÙŠØ± Ù„ØªØ®Ø²ÙŠÙ† Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„ØªÙˆÙ‚Ù Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ

            function toggleStream() {
              const button = document.getElementById("streamButton");

              if (!isStreaming) {
                // Ø¨Ø¯Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ…Ø± Ù„Ù„Ø£Ù…Ø± ZZ
                isStreaming = true;
                button.textContent = "Stop Stream P"; // ØªØºÙŠÙŠØ± Ù†Øµ Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ "Stop Stream"

                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø± ZZ ÙƒÙ„ 1000 Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ© (1 Ø«Ø§Ù†ÙŠØ©)
                streamInterval = setInterval(() => {
                  sendCommand("p");//zz or p
                }, 1000);
                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯ Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø© (60000 Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ©)
                stopTimeout = setTimeout(() => {
                  stopStreaming(); // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª
                }, 20000); // 60000 Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ© = Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©
              } else {
                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ…Ø± Ù„Ù„Ø£Ù…Ø± ZZ
                isStreaming = false;
                button.textContent = "Start Stream"; // ØªØºÙŠÙŠØ± Ù†Øµ Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ "Start Stream"

                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª
                clearInterval(streamInterval);
              }
            }
            function stopStreaming() {
              const button = document.getElementById("streamButton");

              if (isStreaming) {
                isStreaming = false;
                button.textContent = "Start Stream"; // ØªØºÙŠÙŠØ± Ù†Øµ Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ "Start Stream"

                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø¯ÙˆØ±ÙŠ
                clearInterval(streamInterval);

                // Ù…Ø³Ø­ Ù…Ø¤Ù‚Øª Ø§Ù„ØªÙˆÙ‚Ù Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§
                clearTimeout(stopTimeout);
              }
            }

            // function sendCommand(command) {
            //   // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¹Ø¨Ø± Ù…Ù†ÙØ° EDP Ø£Ùˆ Ø£ÙŠ Ø·Ø±ÙŠÙ‚Ø© Ø£Ø®Ø±Ù‰
            //   console.log("Sending command:", command);


            // }
          </script>
          <script>
            // Ø¯Ø§Ù„Ø© Ù„Ø­Ø°Ù Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ù‚Ù„
            function clearInput(X) {
              document.getElementById(X).value = "";
            }
          </script>

          <div id="response1" class="border rounded p-3 overflow-auto "
            style="height: calc(1.5em * 10); white-space: pre-line; text-align: left; background-color: #000; color: #fff;">
            <!-- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
          </div>
        </div>

      </div>
    </div>
    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <main class="container mt-4">
      <!-- <h2>Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙŠØ²Ø§Ù†</h2> -->
      <table id="data-table" class="table table-striped">
        <thead>
          <tr>
            <th>ID</th>
            <th>Ø±Ù‚Ù… Ø§Ù„Ø³ÙŠØ§Ø±Ù‡</th>
            <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
          </tr>
        </thead>
        <tbody>
          <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
        </tbody>
      </table>
      <button id="load-more-btn" class="btn btn-primary w-100">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯</button>
    </main>
    <main class="container mt-4">
      <div class="input-group mb-3">
        <input id="carNumber" type="text" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø³ÙŠØ§Ø±Ù‡" class="form-control">
        <div class="input-group-append">
          <!-- Ø²Ø± "X" Ù„Ø­Ø°Ù Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
          <button type="button" class="btn btn-outline-secondary" onclick="clearInput('carNumber')">X</button>
        </div>
        <div class="input-group-prepend">
          <!-- Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ -->
          <button id="load-more-btn3"type="button" class="btn btn-secondary" >Ø¨Ø­Ø«</button>
        </div>
      </div>


      <!-- <h2>Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ°ÙƒØ±Ø©</h2> -->
      <table id="data-table2" class="table table-striped">
        <thead>
          <tr>
            <!-- // (date, time, sn, number, gross, tare, net)  -->
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
            <th>Ø§Ù„ÙˆÙ‚Øª</th>
            <th>Ø§Ù„Ù…Ø³Ù„Ø³Ù„</th>
            <th>Ø±Ù‚Ù… Ø§Ù„Ø³ÙŠØ§Ø±Ø©</th>
            <th>Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø§ÙˆÙ„</th>
            <th>Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø«Ø§Ù†ÙŠ</th>
            <th>Ø§Ù„ØµØ§ÙÙŠ</th>
          </tr>
        </thead>
        <tbody>
          <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
        </tbody>
      </table>
      <button id="load-more-btn2" class="btn btn-primary w-100">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯</button>


    </main>

    <script>
      let offset = 0; // Ù…ØªØºÙŠØ± Ù„ØªØªØ¨Ø¹ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
      const limit = 5; // Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ Ù„ÙƒÙ„ Ø·Ù„Ø¨

      // Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¹Ø±Ø¶Ù‡Ø§ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
      async function fetchData(X) {
        try {
          const response = await fetch(`/get-data?limit=${limit}&offset=${offset}`);
          const data = await response.json();

          const tableBody = document.querySelector('#data-table tbody');

          // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ù†Ø®ÙÙŠ Ø²Ø± "ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"
          if (data.length === 0) {
            document.getElementById('load-more-btn').style.display = 'none';
            return;
          }
          if (X == 'ok') {
            tableBody.innerHTML = "";
          }
          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
          data.forEach(row => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
               <td>${row.id}</td>
               <td>${row.number}</td>
               <td>${row.data_value}</td>
               <td>${row.date}</td>
                  `;


            tableBody.appendChild(tr);
          });

          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ offset Ù„Ù„Ø·Ù„Ø¨ Ø§Ù„ØªØ§Ù„ÙŠ
          offset += limit;

        } catch (error) {
          console.error('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
        }
      }


      let offset2 = 0; // Ù…ØªØºÙŠØ± Ù„ØªØªØ¨Ø¹ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
      const limit2 = 5; // Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ Ù„ÙƒÙ„ Ø·Ù„Ø¨

      async function fetchData2() {
        try {
          const response = await fetch(`/get-data2?limit=${limit2}&offset=${offset2}`);
          const data = await response.json();

          const tableBody = document.querySelector('#data-table2 tbody');

          // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ù†Ø®ÙÙŠ Ø²Ø± "ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"
          if (data.length === 0) {
            document.getElementById('load-more-btn2').style.display = 'none';
            return;
          }

          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
          data.forEach(row => {
            const tr = document.createElement('tr');
            // (date, time, sn, number, gross, tare, net) 
            tr.innerHTML = `
                            <td>${row.date}</td>
                      <td>${row.time}</td>
                      <td>${row.sn}</td>
                      <td>${row.number}</td>
                      <td>${row.gross}</td>
                      <td>${row.tare}</td>
                      <td>${row.net}</td>
                  `;
            tableBody.appendChild(tr);
          });

          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ offset Ù„Ù„Ø·Ù„Ø¨ Ø§Ù„ØªØ§Ù„ÙŠ
          offset2 += limit2;

        } catch (error) {
          console.error('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
        }
      }
      async function fetchData3() {
        const carNumber = document.getElementById('carNumber').value;
        try {
          const response = await fetch(`/get-data3?carNumber=${carNumber}`);
          const data = await response.json();

          const tableBody = document.querySelector('#data-table2 tbody');

          // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ù†Ø®ÙÙŠ Ø²Ø± "ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"
          if (data.length === 0) {
            document.getElementById('load-more-btn2').style.display = 'none';
            return;
          }
          tableBody.innerHTML = "";
          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
          data.forEach(row => {
            const tr = document.createElement('tr');
            // (date, time, sn, number, gross, tare, net) 
            tr.innerHTML = `
                            <td>${row.date}</td>
                      <td>${row.time}</td>
                      <td>${row.sn}</td>
                      <td>${row.number}</td>
                      <td>${row.gross}</td>
                      <td>${row.tare}</td>
                      <td>${row.net}</td>
                  `;
            tableBody.appendChild(tr);
          });

          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ offset Ù„Ù„Ø·Ù„Ø¨ Ø§Ù„ØªØ§Ù„ÙŠ


        } catch (error) {
          console.error('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
        }
      }





      // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
      window.onload = fetchData;

      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±
      document.getElementById('load-more-btn').addEventListener('click', fetchData);
      document.getElementById('load-more-btn2').addEventListener('click', fetchData2);
      document.getElementById('load-more-btn3').addEventListener('click', fetchData3);
    </script>







    <!-- Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØª -->
    <audio id="audioPlayer" controls style="display:none;"></audio>
  </main>

  <!-- ØªØ¶Ù…ÙŠÙ† Ù…ÙƒØªØ¨Ø© Socket.IO -->
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    // Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…
    function sendTextCommand() {
      var inputValue = document.getElementById("edpInput").value;

      fetch(`/send-command?command=${inputValue}`)
        .then(response => response.text())
        .then(data => {
        })
        .catch(error => {
          console.error('Ø­Ø¯Ø« Ø®Ø·Ø£:', error);
        });
    }
    function sendCommand(command) {
      if (!isStreaming) {
        toggleStream();
      }
      fetch(`/send-command?command=${command}`)
        .then(response => response.text())
        .then(data => {
        })
        .catch(error => {
          console.error('Ø­Ø¯Ø« Ø®Ø·Ø£:', error);
        });
      if (command == 'Kid') {
        // fetchData();
      }

    }
    const streamIndicator = document.getElementById('streamIndicator');
    let count = 0
    // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø¯ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¹Ø¨Ø± WebSocket
    socket.on('response', (data) => {

      if (data.length == 11 || data.length == 12) {
        document.getElementById('response').innerText = data;

        // Ø¥Ø¸Ù‡Ø§Ø± Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¯ÙÙ‚ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø§Ø¯Ù…Ø©
        count++;
        // console.log(count);
        if (count == 80) {
          count = 0;
          streamIndicator.style.visibility = 'hidden';
          streamIndicator.style.opacity = '0'; // ØªØ¬Ø±Ø¨Ø© Ø¥Ø¶Ø§ÙØ© opacity
        } else if (count >= 50) {
          streamIndicator.style.display = 'block'; // Ø¥Ø¸Ù‡Ø§Ø±
          streamIndicator.style.visibility = 'visible';
          streamIndicator.style.opacity = '1'; // ØªØ¬Ø±Ø¨Ø© Ø¥Ø¶Ø§ÙØ© opacity
        }
      } else {



        document.getElementById('response1').innerText += " " + data + "\n";
        console.log(data)
        if (data.slice(-2).toUpperCase() === "NE") {
          document.getElementById('response11').innerText = data;
        }


        const box = document.getElementById('response1');
        box.scrollTop = box.scrollHeight; // ÙŠØ¹Ù…Ù„ Ø³ÙƒØ±ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø£Ø³ÙÙ„   
      }


    });







    function sendNumericCommand() {

      // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø± Ù…Ø¹ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
      fetch(`/send-command?command=KSETTARE=${numericValue}`)
        .then(response => response.text())
        .then(data => {

        })
        .catch(error => {
          console.error('Ø­Ø¯Ø« Ø®Ø·Ø£:', error);
        });

    }

    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØª
    const audioPlayer = document.getElementById('audioPlayer');
    // const statusElement = document.getElementById('status');

    // Ø§Ø³ØªÙ…Ø§Ø¹ Ø¥Ù„Ù‰ Ø¥Ø´Ø§Ø±Ø§Øª ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…
    socket.on('play-audio', (fileName) => {
      const audioUrl = `/audio/${fileName}`; // Ø§Ù„Ù…Ø³Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ
      // statusElement.textContent = `Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„: ${fileName}`;

      // ØªØ­Ø¯ÙŠØ« Ù…ØµØ¯Ø± Ø§Ù„ØµÙˆØª ÙˆØªØ´ØºÙŠÙ„Ù‡
      audioPlayer.src = audioUrl;
      audioPlayer.play();
    });

    // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¹Ù†Ø¯ Ø§Ø³ØªÙ„Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©
    // socket.on('response', (data) => {
    //     // console.log('Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªÙ„Ù…Ø©:', data);
    //     statusElement.textContent = `Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©: ${data}`;
    // });
    socket.on('responseID', (data) => {
      offset = 0;
      fetchData("ok");
    });

  </script>
</body>

</html>